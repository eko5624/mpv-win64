# Maintainer: nyfair <nyfair2012@gmail.com>
pkgname=vapoursynth-dev
pkgver=59
pkgrel=1
pkgdesc='A video processing framework with the future in mind'
arch=('x86_64')
url="http://www.vapoursynth.com/"
license=('LGPL')
source=("git+https://github.com/vapoursynth/vapoursynth#tag=R$pkgver"
        "git+https://github.com/sekrit-twc/zimg#tag=release-3.0.4")
md5sums=('SKIP' 'SKIP')

build() {
  cd $srcdir/zimg
  ./autogen.sh
  ./configure --prefix=/opt --disable-shared
  make install

  cd $srcdir/vapoursynth
  sed -i 's/Cflags: -I${includedir}/Cflags: -I${includedir} -DVS_CORE_EXPORTS/' pc/*.pc.in
  cd $srcdir
  mkdir -p /c/hostedtoolcache/windows/Python/3.10.5/x64/lib/pkgconfig 
  cp ../python3.pc /c/hostedtoolcache/windows/Python/3.10.5/x64//lib/pkgconfig
  ./autogen.sh
  ./configure --prefix=/opt --disable-shared
  make 
}

package() {
  cd $srcdir/vapoursynth
  make DESTDIR=$pkgdir install
  pip install .
}
